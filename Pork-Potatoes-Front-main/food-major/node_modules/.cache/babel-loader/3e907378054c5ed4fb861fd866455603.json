{"ast":null,"code":"import _regeneratorRuntime from\"/Users/minjukim/Documents/GitHub/Pork-Potatoes-Back/Pork-Potatoes-Front-main/food-major/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/minjukim/Documents/GitHub/Pork-Potatoes-Back/Pork-Potatoes-Front-main/food-major/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/minjukim/Documents/GitHub/Pork-Potatoes-Back/Pork-Potatoes-Front-main/food-major/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/minjukim/Documents/GitHub/Pork-Potatoes-Back/Pork-Potatoes-Front-main/food-major/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6;import React,{Component,useState}from\"react\";import styled from\"styled-components\";import'../components/Modals/Modal.css';import logo from'../assets/logo.png';import search from'../assets/search.png';import{fontSize}from\"@material-ui/system\";import Rating from'@material-ui/lab/Rating';import ReactStars from\"react-rating-stars-component\";import{makeStyles}from'@material-ui/core/styles';import axios from\"axios\";import https from\"https\";import swal from\"sweetalert\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Input=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    display:flex;\\n    justify-content: space-around;\\n    align-items: center;\\n    border-radius: 4px;\\n    box-shadow: 0px 4px 4px rgba(51, 51, 51, 0.08), 0px 4px 16px rgba(51, 51, 51, 0.08);\\n    width:35vw;\\n    height:5vh;\\n    border: none;\\n    margin-bottom: 15px;\\n\"])));var InputConsol=styled.input(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    border: none;\\n    outline: none;\\n    width: 35vw;\\n    height: 4vh;\\n\"])));var InputContent=styled.input(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    border: gray;\\n    outline: none;\\n    background-color: #F4F4F4;\\n    width: 35vw;\\n    height: 20vh;\\n    margin-top:14px;\\n    margin-bottom: 14px;\\n\"])));var Button=styled.button(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n    background-color: white;\\n    border: none;\\n    width: 24px;\\n    height: 24px;\\n\"])));var UploadButton=styled.button(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  width:35vw;\\n  height:8vh;\\n  margin-top: 10px;\\n  background-color: white;\\n  border: dashed 1px #999999;\\n  text-align: center;\\n\"])));var RegisterButton=styled.button(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  width:25vw;\\n  min-height: 4vh;\\n  max-height:8vh;\\n  margin-top: 20px;\\n  background-color: white;\\n  border:solid 1px #BABABA;\\n  border-radius: 32px;\\n  text-align: center;\\n  color:#F06D58;\\n\"])));var agent=new https.Agent({rejectUnauthorized:false});function WriteReviewPage(props){var open=props.open,closeModal=props.closeModal;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),inputRestaurant=_useState2[0],setInputRestaurant=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),inputMenu=_useState4[0],setInputMenu=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),inputContent=_useState6[0],setInputContent=_useState6[1];var _useState7=useState(5),_useState8=_slicedToArray(_useState7,2),score=_useState8[0],setScore=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),imageUrl=_useState10[0],setImageUrl=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),file=_useState12[0],setFile=_useState12[1];var processImage=function processImage(event){var imageFile=event.target.files[0];var url=URL.createObjectURL(imageFile);setImageUrl({url:url});setFile({imageFile:imageFile});};var successAddReview=function successAddReview(){swal(\"리뷰가 등록되었습니다.\",{buttons:false,timer:1000});closeModal();};var failAddReview=function failAddReview(){swal(\"리뷰 등록에 실패했습니다..\",{buttons:false,timer:1000});closeModal();};var inputRestaurantChange=function inputRestaurantChange(event){var keyword=event.target.value;setInputRestaurant({keyword:keyword});};var inputMenuChange=function inputMenuChange(event){var keyword=event.target.value;setInputMenu({keyword:keyword});};var inputContentChange=function inputContentChange(event){var keyword=event.target.value;setInputContent({keyword:keyword});};var ratingChanged=function ratingChanged(newRating){setScore({newRating:newRating});};var addReview=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var restaurantObject,userObject,formData,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getRestaurant();case 2:restaurantObject=_context.sent;_context.next=5;return getUser();case 5:userObject=_context.sent;_context.prev=6;formData=new FormData();formData.append('file',file);console.log('file ',file);console.log('formData ',formData);console.log('resobj',restaurantObject);console.log('userobj',userObject);console.log(Object.values(inputContent).toString());console.log(parseFloat(Object.values(score).toString()));console.log(new Date());_context.next=18;return axios.post('https://www.matzipmajor.com/api/reviews',{\"image\":formData,\"requestDto\":{\"restaurant\":restaurantObject,\"user\":userObject,\"content\":Object.values(inputContent).toString(),\"score\":parseFloat(Object.values(score).toString()),\"anonymousFlag\":true,\"menuName\":Object.values(inputMenu).toString(),\"tagFood\":'분식',\"tagMood\":'회식',\"createdDate\":new Date()}});case 18:response=_context.sent;console.log(response);response.status===200?successAddReview():failAddReview();_context.next=26;break;case 23:_context.prev=23;_context.t0=_context[\"catch\"](6);console.log('reviewUpload error');case 26:case\"end\":return _context.stop();}}},_callee,null,[[6,23]]);}));return function addReview(){return _ref.apply(this,arguments);};}();var getRestaurant=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var url,restaurantdata,resNum,url2,restaurantObject;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;url=\"https://www.matzipmajor.com/api/search?q=\"+Object.values(inputRestaurant).toString();_context2.next=4;return axios.get(url,{httpsAgent:agent});case 4:restaurantdata=_context2.sent;resNum=restaurantdata.data[0].restaurantNum;url2=\"https://www.matzipmajor.com/api/restaurants/\"+resNum;_context2.next=9;return axios.get(url2,{httpsAgent:agent});case 9:restaurantObject=_context2.sent;return _context2.abrupt(\"return\",restaurantObject.data);case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](0);console.log(\"getRestaurant error\");case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[0,13]]);}));return function getRestaurant(){return _ref2.apply(this,arguments);};}();var getUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var url,userObject;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;url=\"https://www.matzipmajor.com/api/users/\"+1;_context3.next=4;return axios.get(url,{httpsAgent:agent});case 4:userObject=_context3.sent;return _context3.abrupt(\"return\",userObject.data);case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);console.log(\"getUser error\");case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function getUser(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:open?/*#__PURE__*/_jsx(\"div\",{className:\"modal\",children:/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsx(\"img\",{src:logo,height:\"40px\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close\",onClick:closeModal})]}),/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsxs(Input,{children:[/*#__PURE__*/_jsx(Button,{children:/*#__PURE__*/_jsx(\"img\",{src:search,alt:\"search\",height:\"15px\"})}),/*#__PURE__*/_jsx(InputConsol,{placeholder:\"\\uB9DB\\uC9D1 \\uC774\\uB984\\uC744 \\uC785\\uB825\\uD574 \\uC8FC\\uC138\\uC694\",onChange:inputRestaurantChange})]}),/*#__PURE__*/_jsxs(Input,{children:[/*#__PURE__*/_jsx(Button,{children:/*#__PURE__*/_jsx(\"img\",{src:search,alt:\"search\",height:\"15px\"})}),/*#__PURE__*/_jsx(InputConsol,{placeholder:\"\\uBA54\\uB274\\uB97C \\uC785\\uB825\\uD574 \\uC8FC\\uC138\\uC694\",onChange:inputMenuChange})]}),/*#__PURE__*/_jsx(\"text\",{style:{color:\"rgb(17,17,17,0.48)\",fontSize:\"18px\",marginTop:\"11px\"},children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),/*#__PURE__*/_jsx(ReactStars,{count:5,onChange:ratingChanged,size:24,isHalf:true,emptyIcon:/*#__PURE__*/_jsx(\"i\",{className:\"far fa-star\"}),halfIcon:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star-half-alt\"}),fullIcon:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"}),activeColor:\"#ffd700\"}),/*#__PURE__*/_jsx(\"hr\",{size:\"10px\",width:\"300vw\",color:\"#D7D7D7\"}),/*#__PURE__*/_jsx(\"text\",{style:{fontSize:\"20px\",marginTop:\"20px\"},children:\"\\uC5B4\\uB5A4 \\uC810\\uC774 \\uC88B\\uC558\\uB098\\uC694?\"}),/*#__PURE__*/_jsx(InputContent,{placeholder:\"\\uCD5C\\uC18C 10\\uC790 \\uC774\\uC0C1 \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694.\",onChange:inputContentChange}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:processImage,id:\"input-file\"})]}),/*#__PURE__*/_jsx(\"footer\",{children:/*#__PURE__*/_jsx(RegisterButton,{onClick:addReview,children:\"\\uB9AC\\uBDF0 \\uB4F1\\uB85D\"})})]})}):null});}export default WriteReviewPage;","map":{"version":3,"sources":["/Users/minjukim/Documents/GitHub/Pork-Potatoes-Back/Pork-Potatoes-Front-main/food-major/src/pages/WriteReviewPage.js"],"names":["React","Component","useState","styled","logo","search","fontSize","Rating","ReactStars","makeStyles","axios","https","swal","Input","div","InputConsol","input","InputContent","Button","button","UploadButton","RegisterButton","agent","Agent","rejectUnauthorized","WriteReviewPage","props","open","closeModal","inputRestaurant","setInputRestaurant","inputMenu","setInputMenu","inputContent","setInputContent","score","setScore","imageUrl","setImageUrl","file","setFile","processImage","event","imageFile","target","files","url","URL","createObjectURL","successAddReview","buttons","timer","failAddReview","inputRestaurantChange","keyword","value","inputMenuChange","inputContentChange","ratingChanged","newRating","addReview","getRestaurant","restaurantObject","getUser","userObject","formData","FormData","append","console","log","Object","values","toString","parseFloat","Date","post","response","status","get","httpsAgent","restaurantdata","resNum","data","restaurantNum","url2","color","marginTop"],"mappings":"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","sourcesContent":["import React, { Component,useState } from \"react\";\nimport styled from \"styled-components\";\nimport '../components/Modals/Modal.css';\nimport logo from '../assets/logo.png';\nimport search from '../assets/search.png';\nimport { fontSize } from \"@material-ui/system\";\nimport Rating from '@material-ui/lab/Rating';\nimport ReactStars from \"react-rating-stars-component\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport axios from \"axios\";\nimport https from \"https\";\nimport swal from \"sweetalert\";\n\nconst Input = styled.div`\n    display:flex;\n    justify-content: space-around;\n    align-items: center;\n    border-radius: 4px;\n    box-shadow: 0px 4px 4px rgba(51, 51, 51, 0.08), 0px 4px 16px rgba(51, 51, 51, 0.08);\n    width:35vw;\n    height:5vh;\n    border: none;\n    margin-bottom: 15px;\n`\nconst InputConsol = styled.input`\n    border: none;\n    outline: none;\n    width: 35vw;\n    height: 4vh;\n` \n\nconst InputContent = styled.input`\n    border: gray;\n    outline: none;\n    background-color: #F4F4F4;\n    width: 35vw;\n    height: 20vh;\n    margin-top:14px;\n    margin-bottom: 14px;\n` \nconst Button = styled.button`\n    background-color: white;\n    border: none;\n    width: 24px;\n    height: 24px;\n`\n\nconst UploadButton = styled.button`\n  width:35vw;\n  height:8vh;\n  margin-top: 10px;\n  background-color: white;\n  border: dashed 1px #999999;\n  text-align: center;\n`\n\nconst RegisterButton = styled.button`\n  width:25vw;\n  min-height: 4vh;\n  max-height:8vh;\n  margin-top: 20px;\n  background-color: white;\n  border:solid 1px #BABABA;\n  border-radius: 32px;\n  text-align: center;\n  color:#F06D58;\n`\nconst agent = new https.Agent({\n  rejectUnauthorized: false\n});\n\nfunction WriteReviewPage (props) {\n  const {open,closeModal}=props;\n  const [inputRestaurant,setInputRestaurant]=useState('');\n  const [inputMenu,setInputMenu]=useState('');\n  const [inputContent,setInputContent]=useState('');\n  const [score,setScore]=useState(5);\n  const [imageUrl,setImageUrl]=useState(null);\n  const [file,setFile]=useState(null);\n\n  const processImage = (event) => {\n    const imageFile = event.target.files[0];\n    const url = URL.createObjectURL(imageFile);\n    setImageUrl({url});\n    setFile({imageFile});\n  }\n  const successAddReview = () => {\n    swal(\"리뷰가 등록되었습니다.\", {\n      buttons: false,\n      timer: 1000,\n    });\n    closeModal();\n  }\n  const failAddReview = () => {\n    swal(\"리뷰 등록에 실패했습니다..\", {\n      buttons: false,\n      timer: 1000,\n    });\n    closeModal();\n  }\n  const inputRestaurantChange=(event)=>{\n    const keyword=event.target.value;\n    setInputRestaurant({keyword})\n  }\n  const inputMenuChange=(event)=>{\n    const keyword=event.target.value;\n    setInputMenu({keyword})\n  }\n  const inputContentChange=(event)=>{\n    const keyword=event.target.value;\n    setInputContent({keyword})\n  }\n  const ratingChanged = (newRating) => {\n    setScore({newRating});\n  };\n  const addReview = async () => {\n    const restaurantObject=await getRestaurant();\n    const userObject=await getUser();\n    try{\n      const formData=new FormData();\n      formData.append('file',file);\n      console.log('file ',file);\n      console.log('formData ',formData);\n      console.log('resobj',restaurantObject)\n      console.log('userobj',userObject)\n      console.log(Object.values(inputContent).toString())\n      console.log(parseFloat(Object.values(score).toString()))\n      console.log(new Date())\n      const response = await axios.post('https://www.matzipmajor.com/api/reviews',\n      {\"image\":formData,\n        \"requestDto\":{\n          \"restaurant\":restaurantObject,\n          \"user\":userObject,\n          \"content\":Object.values(inputContent).toString(),\n          \"score\":parseFloat(Object.values(score).toString()),\n          \"anonymousFlag\":true,\n          \"menuName\":Object.values(inputMenu).toString(),\n          \"tagFood\":'분식',\n          \"tagMood\":'회식',\n          \"createdDate\":new Date(),\n        }\n      });\n      console.log(response)\n      response.status===200 ? successAddReview() : failAddReview();\n    }\n    catch(e){\n      console.log('reviewUpload error');\n    }\n  }\n  const getRestaurant= async () => {\n    try{\n      const url=\"https://www.matzipmajor.com/api/search?q=\"+Object.values(inputRestaurant).toString();\n      const restaurantdata = await axios.get(url, {httpsAgent: agent});\n      const resNum = restaurantdata.data[0].restaurantNum;\n      const url2=\"https://www.matzipmajor.com/api/restaurants/\"+resNum;\n      const restaurantObject = await axios.get(url2, {httpsAgent: agent});\n      return restaurantObject.data;\n    }\n    catch(e){\n      console.log(\"getRestaurant error\");\n    }\n  }\n  const getUser= async () => {\n    try{\n      const url=\"https://www.matzipmajor.com/api/users/\"+1;\n      const userObject = await axios.get(url, {httpsAgent: agent});\n      return userObject.data;\n    }\n    catch(e){\n      console.log(\"getUser error\");\n    }\n  }\n\n\n  return (\n    <>\n    {open?(\n        <div className='modal'>\n          <section>\n            <header>\n              <img src={logo} height='40px'></img>\n              <button className=\"close\" onClick={closeModal}></button>\n            </header>\n            <main>\n              <Input>\n                <Button><img src={search} alt=\"search\" height=\"15px\"/></Button>\n                <InputConsol placeholder=\"맛집 이름을 입력해 주세요\"\n                onChange={inputRestaurantChange}/>\n              </Input>\n              <Input>\n                <Button><img src={search} alt=\"search\" height=\"15px\"/></Button>\n                <InputConsol placeholder=\"메뉴를 입력해 주세요\"\n                onChange={inputMenuChange}/>\n              </Input>\n              <text style={{color:\"rgb(17,17,17,0.48)\", fontSize:\"18px\",marginTop:\"11px\"}}>선택하세요</text>\n              <ReactStars\n                count={5}\n                onChange={ratingChanged}\n                size={24}\n                isHalf={true}\n                emptyIcon={<i className=\"far fa-star\"></i>}\n                halfIcon={<i className=\"fa fa-star-half-alt\"></i>}\n                fullIcon={<i className=\"fa fa-star\"></i>}\n                activeColor=\"#ffd700\"\n              />\n              <hr size=\"10px\" width=\"300vw\" color=\"#D7D7D7\" />\n              <text style={{fontSize:\"20px\",marginTop:\"20px\"}}>어떤 점이 좋았나요?</text>\n              <InputContent placeholder=\"최소 10자 이상 입력해주세요.\" \n              onChange={inputContentChange}/>\n              <input type=\"file\" accept=\"image/*\" onChange={processImage} id=\"input-file\"/> \n            </main>\n            <footer>\n              <RegisterButton onClick={addReview} >리뷰 등록</RegisterButton>\n            </footer>\n          </section>\n        </div>\n    ):null}\n    </>\n  );\n}\n\nexport default WriteReviewPage;"]},"metadata":{},"sourceType":"module"}